<!doctype html>
<html>

<head>
  <link href="styles.css" rel="stylesheet" type="text/css">
  <meta charset="utf-8" />
  <title>UC Dash</title>
  <meta name="viewport" content="width=device-width">

</head>

<body>
  <div id="dog" class="flip-it"><img id="what" src="http://10.44.80.2:5800/?action=stream"></div>

  <div id="AutoTitle">
    Auto:
  </div>

  <select id="autonomous" style="font-size:20px"></select>

  <div class="square">
    <div class="container">
      <div id="gg1" class="gauge"></div>

    </div>
  </div>

    <script src="raphael-2.1.4.min.js"></script>
    <script src="justgage.js"></script>
    <script src="/networktables/networktables.js"></script>
    <script src="/networktables/utils.js"></script>
    <script src="jquery-2.2.2.min.js"></script>
    <script src="d3.min.js"></script>
    </br>
    </br>
      </br>
    </br>
      </br>
    </br>
        </br>

  <div id="f1"></div>
  <div id="f2"></div>
  <div id="f3"></div>
  <div id="f4"></div>
  <div id="f5"></div>
  <div id="f6"></div>
  <div id="f7"></div>
  <div id="f8"></div>
  <div id="birdseye">
    <img src="http://10.44.80.12:8080/?action=stream">
  </div>
  <div id="myProgress">
  <div id="myBar"></div>
  </div>



  <script>
    var width = 1;
    var total = 0;


    document.addEventListener("DOMContentLoaded", function(event) {
  attachSelectToSendableChooser("#autonomous", "/SmartDashboard/Autonomous Mode")
      var dflt1 = {
        min: 0,
        max: 120,
        donut: false,
        gaugeWidthScale: 0.7,
        title: "PSI",
        counter: true,
        titleFontColor: "red",
        hideInnerShadow: false
      }


      var gg1 = new JustGage({
        id: 'gg1',
        value: 0,
        defaults: dflt1,
        valueFontColor: "white"
      });

      NetworkTables.addRobotConnectionListener(function(onRobotConnection){
      document.getElementById("gg1").style.border ="30px solid green";
      }, true);

      NetworkTables.addWsConnectionListener(function(connected){
              console.log("Websocket connected: " + connected);
          }, true);

      NetworkTables.addGlobalListener(function(key, value, isNew){
        //console.log(key);
        console.log(value);
      if(key=="/SmartDashboard/PSI"){
          gg1.refresh(((value-.583)*50.631));

                      }
      else if(key=="/SmartDashboard/TIME"){
          color(value);
        move(value);
        }
      else if(key=="/SmartDashboard/F1"){

          distanceToColor(value, "f1");

      };

       }, true);
    });

  function move(number) {
      var elem = document.getElementById("myBar");
      elem.style.width = ((150-number)/150)*100 + '%';

  };

  function distanceToColor(number, one){
      var totalNumber = number*4;
      if (totalNumber > 254){
          totalNumber = 255;
        };
      var reds = Math.round(255-totalNumber);
      var greens = Math.round(totalNumber);
      console.log(reds);
      document.getElementById("f1").style.backgroundColor = "rgb("+reds+","+greens+",0)";


  }

  function color(number) {

        var actual = 150-number;
        var totaled = 0;

        if (actual> 134){
        document.getElementById("myBar").style.backgroundColor ="blue";
        }

        else{

          totaled=actual*2;

        if (totaled>255){
          totaled=255;
        };

        var green = totaled;
        var red = 255-totaled;

        document.getElementById("myBar").style.backgroundColor ="rgb("+red+","+green+",0)";

    };

    };
    </script>

</body>

</html>
