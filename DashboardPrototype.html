<!doctype html>
<html>

<head>
  <meta charset="utf-8" />
  <title>UC Dash</title>
  <meta name="viewport" content="width=device-width">
  <style>
  .container {
    width: 2000px auto;
    margin: 100px auto;
    
    text-align: left;
  }

  .gauge {
    width: 300px;
    height: 250px;
    
  }
  body{

      background-image: url(http://10.44.80.20:5800/?action=stream);

      background-size: 1300px;
  }

  </style>
</head>

<body>
Autonomous: <select id="autonomous"></select>
<div class="square">
  <div class="container">
    <div id="gg1" class="gauge"></div>
    <div id="gg2" class="gauge"></div>
  </div>
  </div>
<div>
  <span id="robotIndicator"></span>
  Robot: <span id="robotstate">Unknown state</span> @ <span id="robotAddress">disconnected</span>
</div>
  <script src="raphael-2.1.4.min.js"></script>
  <script src="justgage.js"></script>
  <script src="/networktables/networktables.js"></script>
  <script src="/networktables/utils.js"></script>
  <script src="jquery-2.2.2.min.js"></script>
  <script src="d3.min.js"></script>
  
  <script>

  document.addEventListener("DOMContentLoaded", function(event) {

    var dflt1 = {
      min: 0,
      max: 100,
      donut: false,
      gaugeWidthScale: 0.7,
      title: "PSI",
      counter: true,
      titleFontColor: "red",
      hideInnerShadow: false
    }
    var dflt2 = {
      min: 0,
      max: 360,
      donut: false,
      gaugeWidthScale: 0.7,
      title: "Gyro",
      counter: true,
      titleFontColor: "red",
      donut: true
    }


    var gg1 = new JustGage({
      id: 'gg1',
      value: 0,
      defaults: dflt1,
      valueFontColor: "white"
    });

    var gg2 = new JustGage({
        id: 'gg2',
        value: 180,
        defaults: dflt2,
        valueFontColor: "white"
    });
    function onRobotConnection(connected) {
	$('#robotstate').text(connected ? "Connected!" : "Disconnected");
	$('#robotAddress').text(connected ? NetworkTables.getRobotAddress() : "disconnected");
}

$(document).ready(function(){
  // sets a function that will be called when the robot connects/disconnects
	NetworkTables.addRobotConnectionListener(onRobotConnection, true);
	
	attachRobotConnectionIndicator('#robotIndicator');
  
  // attaches the select element to a SendableChooser object
  attachSelectToSendableChooser("#autonomous", "Autonomous Mode");
});

    NetworkTables.addWsConnectionListener(function(connected){
            console.log("Websocket connected: " + connected);
        }, true);
                     
    NetworkTables.addGlobalListener(function(key, value, isNew){
    if(key=="/SmartDashboard/joystick"){
            gg1.refresh((value*100));
            console.log(key);
                    };
                                    
                }, true);
  
                                 

    

  });
  </script>
  
</body>

</html>
